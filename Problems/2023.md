Problems and how I solved them (ish) <!-- omit in toc -->
===

**Table of Contents**
- [1. DDS](#1-dds)
  - [1.0. DDS](#10-dds)
  - [1.1. OpenDDS](#11-opendds)
  - [1.2. RTIDDS](#12-rtidds)
  - [1.3. FastDDS](#13-fastdds)
- [2. Ubuntu](#2-ubuntu)
- [3. Kubernetes](#3-kubernetes)
- [4. Mac OS](#4-mac-os)
- [5. Gitlab](#5-gitlab)
- [6. Proxmox](#6-proxmox)


# 1. DDS
## 1.0. DDS
* OpenDDS vs RTIDDS
  * Desc : opendds is slower than rtidds?
  * State : opened
  * Date : idk... but about 23-10-??
  * Detail : opendds is apparently faster than rtidds by yskim... why...?
  * Solution :
    * ~~for java environments opendds is faster when topic size is bigger~~ : now even this is apparently not true...? (12/13)

## 1.1. OpenDDS
* RTPS_UDP perftest
  * Desc : when using rtps_udp as transport, pub can find sub but sub cannot.
  * State : closed?
  * Date : 23-11-13
  * Solution : 
    * ~~use tcp instead for now...~~
    * place Pdatawriter and Pdatareader on the same domain (same for Sdw, Sdr)
  
## 1.2. RTIDDS
* Big Topic
  * Desc : error on write when writing topic with string size > 256
  * State : closed?
  * Date : 23-10-15
  * Solution : specify string size from idl(e.g. string<512> message)
    > max string lenth is fixed in idlname.cxx generated by rtiddsgen?
  * Reference : idlname.cxx:347 `::rti::topic::allocate_sample(sample.message(), -1, 512L)`
  * Future reference : topic_data_max_length from Qos settings?
* USER_QOS_PROFILES.xml
  * Desc : can't load qos.xml using dds::core::QosProvider class
  * State : closed
  * Date : 23-10-15
  * Solution : rename USER_QOS_PROFILES.xml to something else
    > rtidds reads qos.xml from `$NDDS_QOS_PROFILES` and `USER_QOS_PROFILES.xml` in the working directory, so it causes rti to reload the same qos?
* Default Qos.xml
  * Desc : where's the default qos.xml files?
  * State : closed
  * Date : 23-10-15
  * Solution : it's defined inside the rti library files, but can be referenced via `$NDDSHOME/resource/xml/BuiltinProfiles.documentONLY.xml`
    > additional note : `BuiltinQosLibExp` is deprecated and is still defined just for backward compatibility issues.
* Using other than UDPv4|SHMEM as transport
  * Desc : participant_qos-transport_builtin-mask TCP not working
  * State : closed
  * Date : 23-10-15
  * Solution : there's a lot to setup. referenced from #b
  * Reference :
    1. [DDS_TransportBuiltinKind](https://community.rti.com/rti-doc/500/ndds/doc/html/api_cpp/group__DDSTransportBuiltinQosModule.html "https://community.rti.com/rti-doc/500/ndds/doc/html/api_cpp/group__DDSTransportBuiltinQosModule.html") : Only UDPv4, SHMEM, UDPv6 exists
    2. [UDP for discovery, TCP for data](https://community.rti.com/kb/using-udp-discovery-and-tcp-user-data "https://community.rti.com/kb/using-udp-discovery-and-tcp-user-data")
* DomainParticipant as class member
  * Desc : title
  * State : closed
  * Date : 23-11-06
  * Solution : [ref](https://community.rti.com/forum-topic/error-domainparticipant-member "https://community.rti.com/forum-topic/error-domainparticipant-member")


## 1.3. FastDDS

# 2. Ubuntu
* Keeps freezing on boot
  * Desc : title
  * State : open
  * Date : 23-11-09 ~
  * Solution :
  * Reference :
    1. [i2c_nvidia_gpu](https://askubuntu.com/questions/1278399/dual-system-ubuntu-20-04nvidia-gpu-i2c-timeout-error-ucsi-ccg-i2c-transfer "https://askubuntu.com/questions/1278399/dual-system-ubuntu-20-04nvidia-gpu-i2c-timeout-error-ucsi-ccg-i2c-transfer")
    2. [NvKmsKapiDevice](https://askubuntu.com/questions/1436629/ubuntu-22-04-1-lts-rtx-3060ti-failed-to-allocate-nvkmskapidevice "https://askubuntu.com/questions/1436629/ubuntu-22-04-1-lts-rtx-3060ti-failed-to-allocate-nvkmskapidevice")
    3. [psmouse](https://askubuntu.com/questions/1234345/psmouse-serio-1-error "https://askubuntu.com/questions/1234345/psmouse-serio-1-error")
    4. sysrq(alt, fn, sysrq) + REISUB
* xrdp black screen
  * Desc : title
  * State : closed
  * Date : 23-11-13
  * Solution : edit /etc/xrdp/startwm.sh
     ```bash
    unset DBUS_SESSION_BUS_ADDRESS
    unset XDG_RUNTIME_DIR
    ```
* No Mouse/Keyboard over xrdp
  * Desc : title
  * Static : closed
  * Date : 23-11-13
  * Solution : [ref](https://askubuntu.com/questions/1347943/mouse-and-keyboard-not-working-on-ubuntu-20-04-remote-desktop-after-login "https://askubuntu.com/questions/1347943/mouse-and-keyboard-not-working-on-ubuntu-20-04-remote-desktop-after-login")
* Increase vmware space
  * Dec : title
  * State : closed
  * Date : 23-11-24
  * Solution : 
    ```text
    To increase the volume size of an Ubuntu virtual machine in VMware, you can follow these general steps:
    1. Shut down the Ubuntu virtual machine.
    2. In VMware, select the Ubuntu virtual machine and click on the "Edit virtual machine settings" option.
    3. In the "Hardware" tab, select the virtual hard disk that you want to resize and click on the "Edit..." button.
    4. In the "Virtual Hard Disk Properties" window, increase the disk capacity to the desired size.
    5. Click on the "OK" button to save the changes.
    6. Start the Ubuntu virtual machine.
    Once the Ubuntu virtual machine has started, you will need to use a partitioning tool to resize the partition to make use of the additional space. Here are the general steps:
    1. Open a terminal window in Ubuntu.
    2. Type "sudo fdisk -l" to list the available disks and partitions.
    3. Identify the partition that you want to resize.
    4. Type "sudo parted /dev/sda" (replace "sda" with the name of the disk that contains the partition).
    5. Type "print" to list the partitions on the disk.
    6. Type "resizepart N" (replace "N" with the number of the partition that you want to resize).
    7. Type "Yes" to confirm that you want to continue.
    8. Type "END" to specify the end of the partition.
    9. Type "Yes" to confirm the new partition size.
    10. Type "quit" to exit parted.
    11. Type "sudo resize2fs /dev/sdaN" (replace "sda" with the name of the disk and "N" with the number of the partition that you resized).
    12. Wait for the resizing process to complete.
    After these steps, the partition should now be resized and you should have access to the additional space in your Ubuntu virtual machine.
    ```
* Increase LVM space
  * Dec : title
  * State : closed
  * Date : 23-11-24
  * Solution : [ref](https://4sysops.com/archives/extending-lvm-space-in-ubuntu/ "https://4sysops.com/archives/extending-lvm-space-in-ubuntu/")
    ```bash
    sudo pvresize /dev/sda3
    sudo lvextend -l +100%FREE -r /dev/ubuntu-vg/ubuntu-lv
    ```
* VMware
  * Desc : vmware modules not installing - vmmon, vmnet
  * State : closed
  * Date : 23-12-06
  * Solution :
  ```bash
  # try this first
  sudo vmware-modconfig --console --install-all

  git clone --branch=workstation-16.2.5 https://github.com/mkubecek/vmware-host-modules.git

  cd vmware-host-modules
  make
  sudo make install

  mkdir MOK
  cd MOK
  openssl req -new -x509 -newkey rsa:2048 -keyout MOK.priv -outform DER -out MOK.der -nodes -days 36500 -subj "/CN=VMWare"
  sudo /usr/src/linux-headers-5.15.0-89-generic/scripts/sign-file sha256 ./MOK.priv ./MOK.der $(modinfo -n vmmon)
  sudo /usr/src/linux-headers-5.15.0-89-generic/scripts/sign-file sha256 ./MOK.priv ./MOK.der $(modinfo -n vmnet)

  sudo su
  mokutil --import MOK.der
  sudo shutdown -r now
  ```
  * Reference : [ref](https://www.bearpooh.com/25 "https://www.bearpooh.com/25")
    [ref](https://unix.stackexchange.com/questions/439529/before-you-can-run-vmware-several-modules-must-be-compiled "https://unix.stackexchange.com/questions/439529/before-you-can-run-vmware-several-modules-must-be-compiled")

# 3. Kubernetes
* Pod gets evicted
  * Desc : The node was low on resource: ephemeral-storage
  * State : open
  * Date : 23-11-24
  * Solution : increase vmware volume....
  * References :
    * node disk pressure
    * set resource limits : [ref](https://velog.io/@holicme7/K8s-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EC%A0%9C%ED%95%9C "https://velog.io/@holicme7/K8s-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EC%A0%9C%ED%95%9C")
    ```yaml
    apiVersion: apps/v1
    kind: Deployment
    spec:
      template:
        spec:
          containers:
          - resources:
              requests:
                ephemeral-storage: "1024Mi"
              limits:
                ephemeral-storage: "2048Mi"
    ```
    * [ref](https://my-grope-log.tistory.com/15 "https://my-grope-log.tistory.com/15")
* Gitlab Registry
  * Desc : can't pull my gitlab registry
  * State : open
  * Date : 23-11-30
  * Solution : 

```bash
vim /etc/containerd/config.toml
# [plugins."io.containerd.grpc.v1.cri".registry.mirrors]
# [plugins."io.containerd.grpc.v1.cri".registry.mirrors."pinlab.kro.kr:5050"]
#   endpoint = ["https://pinlab.kro.kr:5050"]

#some refs : https://stackoverflow.com/questions/62930043/getting-x509-certificate-signed-by-unknown-authority-by-microk8s
# https://github.com/containerd/nerdctl/blob/main/docs/faq.md#how-to-specify-the-ca-certificate-of-the-registry

vim /usr/local/share/ca-certificates/pinlab.kro.kr:5050

# https://chris-vermeulen.com/using-gitlab-registry-with-kubernetes/
cat -n "username:password" | base64
vim .dockerconfigjson
# {
# 	"auths":
# 		{
# 			"https://pinlab.kro.kr:5050":
# 				{
# 					"username":"kube-puller",
# 					"password":"1Z5X...",
# 					"auth":"a3ViZS1wdWxsZXI6MVo1WFh0TGZSNFV3RG14M0xTV3I="
# 				}
# 		}
# }

cat .dockerconfigjson | base64
vim registry-credentials.yaml
# apiVersion: v1
# kind: Secret
# metadata:
#   name: registry-credentials
#   namespace: default
# type: kubernetes.io/dockerconfigjson
# data:
#   .dockerconfigjson: ewoJImF1dGhzIjoKCQl7Cgk....

# 1. Deployment
# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   ...
# spec:
#   template:
#     metadata:
#       ...
#     spec:
#       containers:
#       - name: ...
#       imagePullSecrets: 
#       - name: registry-credentials

# 2. ServiceAccount : doesn't work?
# apiVersion: v1
# kind: ServiceAccount
# metadata:
#   name: default
#   namespace: default
# imagePullSecrets:
# - name: registry-credentials
#
# ???
# Warning: resource serviceaccounts/default is missing the kubectl.kubernetes.io/last-applied-configuration annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create --save-config or kubectl apply. The missing annotation will be patched automatically.
# serviceaccount/default configured
```


# 4. Mac OS
* Docker Gitlab
  * Desc : gitlab installation using docker image causes connection to psql fail?
  * State : closed
  * Date : 23-11-27
  * Solution : [ref](https://forums.docker.com/t/docker-desktop-for-macs-virtualization-framework-is-unable-to-run-the-gitlab-docker-image/136742 "https://forums.docker.com/t/docker-desktop-for-macs-virtualization-framework-is-unable-to-run-the-gitlab-docker-image/136742")

# 5. Gitlab
* Registry Push
  * Desc : `error parsing HTTP 404 response body: invalid character '<'` ...
  * State : closed
  * Date : 23-11-30
  * Solution : add registry port to `registry_external_url`
* Registry Push (2)
  * Desc : `denied: requested access to the resource is denied`
  * State : closed
  * Date : 23-11-30
  * Solution : fix image tag
    * `registry.example.com/group/project/image`
    * [Reference](https://docs.gitlab.com/ee/user/packages/container_registry/build_and_push_images.html "https://docs.gitlab.com/ee/user/packages/container_registry/build_and_push_images.html")
  
# 6. Proxmox
* Networking
  * Desc : title
  * State : open
  * Date : 23-12-20
  * Solution : SDN using VLAN or VXLAN, carefull with firewall
  * References : [official_doc](https://pve.proxmox.com/pve-docs/chapter-pvesdn.html#pvesdn_setup_example_vlan "https://pve.proxmox.com/pve-docs/chapter-pvesdn.html#pvesdn_setup_example_vlan")  
    [ref](https://forum.proxmox.com/threads/is-there-a-cluster-bridge-or-cluster-level-networking.124309/ "https://forum.proxmox.com/threads/is-there-a-cluster-bridge-or-cluster-level-networking.124309/")  
    [ref](https://hwanstory.kr/@kim-hwan/posts/Proxmox-Virtual-Private-Network-Configuration "https://hwanstory.kr/@kim-hwan/posts/Proxmox-Virtual-Private-Network-Configuration")
  * Backup References : [ref](https://mattglass-it.com/software-defined-network-proxmox/ "https://mattglass-it.com/software-defined-network-proxmox/")  
    [post_install](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqa3RtY2tUZVVRTEh3TGZwMWVRMmZSeHpuRklYZ3xBQ3Jtc0tsTFZHQ0pqdWx1VENMUEpMM2dpZGs4YjNwMXYzY1JENHYzM1JEcFcyeEwxSThRUnlCaElXcEwySVBxVVhDNWNGbjY2SEd3ZmczQy1CODVZSDZVVGRWd19oZ0ltU0N3UENKOFBmcW5kNFRqUmZZNEpmSQ&q=https%3A%2F%2Ftteck.github.io%2FProxmox%2F&v=5axVd19Jris "https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqa3RtY2tUZVVRTEh3TGZwMWVRMmZSeHpuRklYZ3xBQ3Jtc0tsTFZHQ0pqdWx1VENMUEpMM2dpZGs4YjNwMXYzY1JENHYzM1JEcFcyeEwxSThRUnlCaElXcEwySVBxVVhDNWNGbjY2SEd3ZmczQy1CODVZSDZVVGRWd19oZ0ltU0N3UENKOFBmcW5kNFRqUmZZNEpmSQ&q=https%3A%2F%2Ftteck.github.io%2FProxmox%2F&v=5axVd19Jris") [ref](https://tteck.github.io/Proxmox/ "https://tteck.github.io/Proxmox/")  
    [not_good](https://www.youtube.com/watch?v=UZ9mfxNMyHw&ab_channel=Jim%27sGarage "https://www.youtube.com/watch?v=UZ9mfxNMyHw&ab_channel=Jim%27sGarage")
* Delete Cluster
  * Desc : title
  * State : open
  * Date : 23-12-20
  * Solution : [ref](https://forum.proxmox.com/threads/proxmox-ve-6-removing-cluster-configuration.56259/ "https://forum.proxmox.com/threads/proxmox-ve-6-removing-cluster-configuration.56259/")